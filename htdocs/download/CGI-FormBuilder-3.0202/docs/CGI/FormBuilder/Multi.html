<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html
        PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
         "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
<title>FormBuilder - Perl CGI Form Builder CPAN module</title>
<link type="text/css" rel="stylesheet" href="/layout/style.css" />
<script src="/js/miniwin.js" type="text/javascript"></script>
</head>
<body>
<!-- top navbar -->
<table width="100%" border="0" cellspacing="0" class="bar"><tr>
<td width="228"><a href="/"><img src="/images/fb_logo5.gif" width="228" height="42" 
 border="0" alt="Perl Form Builder" /></a></td>
<td class="bar">
   ::<a href="/features/" class="bar">Features</a>
   ::<a href="/download/" class="bar">Download</a>
   ::<a href="/tutor/" class="bar">Tutorial</a>
   ::<a href="/ex/" class="bar">Examples</a>
   <br />
   ::<a href="/docs/" class="bar">Documentation</a>
   ::<a href="/mailman/listinfo/fbusers" class="bar">Join the Mailing List</a>
   ::<a href="http://blog.gmane.org/gmane.comp.lang.perl.modules.formbuilder" class="bar">List Archives</a>
   ::<a href="/contrib/" class="bar">Contribute</a>
</td>
<td class="bar" align="center" valign="middle">
<!-- BEGIN PAYPAL CODE -->
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_xclick" />
<input type="hidden" name="business" value="nate@wiger.org" />
<input type="hidden" name="item_name" value="FormBuilder development support" />
<input type="image" src="http://www.paypal.com/images/x-click-but04.gif" 
name="submit" alt="Donate using PayPal" />
</form>
</td>
</tr>
</table>
<!-- spacer -->
<div id="navspacer"><img src="/images/clear.gif" width="1" height="1"></div>
<table class="body" border="0" cellpadding="5" cellspacing="0">
<tr><td valign="top" class="body">
<!-- opens the left navbar -->
<table border="0" cellpadding="5" cellspacing="0" class="leftnav">
<tr>
<td valign="top" class="leftnav">
<font size=2>
<form action="/redirect.pl" method="GET">
<select name="url" onChange="this.form.submit()">
<option value="/download/CGI-FormBuilder-3.0202/docs/CGI/FormBuilder/Field.html">CGI::FormBuilder::Field</option>
<option value="/download/CGI-FormBuilder-3.0202/docs/CGI/FormBuilder/Messages.html">CGI::FormBuilder::Messages</option>
<option value="/download/CGI-FormBuilder-3.0202/docs/CGI/FormBuilder/Multi.html" selected>CGI::FormBuilder::Multi</option>
<option value="/download/CGI-FormBuilder-3.0202/docs/CGI/FormBuilder.html">CGI::FormBuilder</option>
<option value="/download/CGI-FormBuilder-3.0202/docs/CGI/FormBuilder/Source/File.html">CGI::FormBuilder::Source::File</option>
<option value="/download/CGI-FormBuilder-3.0202/docs/CGI/FormBuilder/Source.html">CGI::FormBuilder::Source</option>
<option value="/download/CGI-FormBuilder-3.0202/docs/CGI/FormBuilder/Template/Fast.html">CGI::FormBuilder::Template::Fast</option>
<option value="/download/CGI-FormBuilder-3.0202/docs/CGI/FormBuilder/Template/HTML.html">CGI::FormBuilder::Template::HTML</option>
<option value="/download/CGI-FormBuilder-3.0202/docs/CGI/FormBuilder/Template.html">CGI::FormBuilder::Template</option>
<option value="/download/CGI-FormBuilder-3.0202/docs/CGI/FormBuilder/Template/Text.html">CGI::FormBuilder::Template::Text</option>
<option value="/download/CGI-FormBuilder-3.0202/docs/CGI/FormBuilder/Template/TT2.html">CGI::FormBuilder::Template::TT2</option>
<option value="/download/CGI-FormBuilder-3.0202/docs/CGI/FormBuilder/Util.html">CGI::FormBuilder::Util</option>
<option value=/docs/>Version other than 3.0202</option>
</select></form></font>
<style>ul { margin-left: 0; padding-left: 10px; }</style>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>CGI::FormBuilder::Multi - Create multi-page FormBuilder forms</title>
<link rev="made" href="mailto:root@localhost" />
</head>

<body style="background-color: white">

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<li><a href="#methods">METHODS</a></li>
	<ul>

		<li><a href="#new___form1____form2__opt____val_">new(\%form1, \%form2, opt =&gt; val)</a></li>
		<li><a href="#form__"><code>form()</code></a></li>
		<li><a href="#page__num_"><code>page($num)</code></a></li>
		<li><a href="#pages__"><code>pages()</code></a></li>
		<li><a href="#navbar__onoff_"><code>navbar($onoff)</code></a></li>
	</ul>

	<li><a href="#see_also">SEE ALSO</a></li>
	<li><a href="#revision">REVISION</a></li>
	<li><a href="#author">AUTHOR</a></li>
</ul>
<!-- INDEX END -->

<!-- closes the left navbar -->
</td></tr></table></td><td valign="top" class="body">

<p>
</p>
<h1><a name="name">NAME</a></h1>
<p>CGI::FormBuilder::Multi - Create multi-page FormBuilder forms</p>
<p>
</p>

<h1><a name="synopsis">SYNOPSIS</a></h1>
<pre>
    use CGI::FormBuilder::Multi;
    use CGI::Session;   # or something similar

    # Top-level &quot;meta-form&quot;
    my $multi = CGI::FormBuilder::Multi-&gt;new(

        # form 1 options
        { fields   =&gt; [qw(name email daytime_phone evening_phone)],
          title    =&gt; 'Basic Info',
          template =&gt; 'page1.tmpl',
          validate =&gt; { name =&gt; 'NAME', email =&gt; 'EMAIL' },
          required =&gt; [qw(name email daytime_phone)],
        },

        # form 2 options
        { fields   =&gt; [qw(billing_name billing_card billing_exp
                          billing_address billing_city billing_state
                          billing_zip billing_phone)],
          title    =&gt; 'Billing',
          template =&gt; 'page2.tmpl',
          required =&gt; 'ALL',
        },

        # form 3 options
        { fields   =&gt; [qw(same_as_billing shipping_address
                          shipping_city shipping_state shipping_zip)],
          title    =&gt; 'Shipping',
          template =&gt; 'page3.tmpl',
          required =&gt; 'ALL',
        },

        # a couple options specific to this module
        navbar =&gt; 1,

        # remaining options (not in hashrefs) apply to all forms
        header =&gt; 1,
        method =&gt; 'POST',
        submit =&gt; 'Continue',
        values =&gt; $dbi_hashref_query,
    );

    # Get current page's form
    my $form = $multi-&gt;form;

    if ($form-&gt;submitted &amp;&amp; $form-&gt;validate) {

        # Retrieve session id
        my $sid = $form-&gt;sessionid;

        # Initialize session
        my $session = CGI::Session-&gt;new(&quot;driver:File&quot;, $sid, {Directory=&gt;'/tmp'});

        # Automatically store updated data in session
        $session-&gt;save_param($form);

        # last page?
        if ($multi-&gt;page == $multi-&gt;pages) {
            print $form-&gt;confirm;
            exit;
        }

        # Still here, goto next page
        $multi-&gt;page++;

        # And re-get form (no &quot;my&quot; on $form!)
        $form = $multi-&gt;form;

        # Make sure it has the right sessionid
        $form-&gt;sessionid($session-&gt;id);

        # on page 3 we have special field handling
        if ($multi-&gt;page == 3) {
            $form-&gt;field(name    =&gt; 'same_as_billing',
                         type    =&gt; 'checkbox',
                         options =&gt; 'Yes',
                         jsclick =&gt; 'this.form.submit()');
        }
    }

    # Fall through and print next page's form
    print $form-&gt;render;</pre>
<p>
</p>

<h1><a name="description">DESCRIPTION</a></h1>
<p>This module works with <code>CGI::FormBuilder</code> to create multi-page forms.
Each form is specified using the same options you would pass directly
into <strong>FormBuilder</strong>. See <a href="/download/CGI-FormBuilder-3.0202/docs/CGI/FormBuilder.html">the CGI::FormBuilder manpage</a> for a list of these options.</p>
<p>The multi-page ``meta-form'' is a composite of the individual forms you
specify, tied together via the special <code>_page</code> CGI param. The current
form is available via the <code>form()</code> method, and the current page is
available via <code>page()</code>. It's up to you to navigate appropriately:</p>
<pre>
    my $multi = CGI::FormBuilder::Multi-&gt;new(...);

    # current form
    my $form  = $multi-&gt;form;

    $multi-&gt;page++;         # page forward
    $multi-&gt;page--;         # and back
    $multi-&gt;page = $multi-&gt;pages;   # goto last page

    # current form
    $form = $multi-&gt;form;</pre>
<p>To make things are fluid as possible, you should title each of your
forms, even if you're using a template. This will allow <code>::Multi</code>
to create cross-links by-name instead of just ``Page 2''.</p>
<p>
</p>

<h1><a name="methods">METHODS</a></h1>
<p>The following methods are provided:</p>
<p>
</p>
<h2><a name="new___form1____form2__opt____val_">new(\%form1, \%form2, opt =&gt; val)</a></h2>
<p>This creates a new <code>CGI::FormBuilder::Multi</code> object. Forms are
specified as hashrefs of options, in sequential order, similar to
how fields are specified. The order the forms are in is the order
that the pages will cycle through.</p>
<p>In addition to a hashref, forms can be directly specified as a
<code>$form</code> object that has already been created. For existing objects,
the below does not apply.</p>
<p>When the first non-ref argument is seen, then all remaining args
are taken as common options that apply to all forms. In this way,
you can specify global settings for things like <code>method</code> or
<code>header</code> (which will likely be the same), and then override
individual settings like <code>fields</code> and <code>validate</code> on a per-form
basis.</p>
<p>The <a href="#synopsis">SYNOPSIS</a> above is very representative of typical usage.</p>
<p>
</p>
<h2><a name="form__"><code>form()</code></a></h2>
<p>This returns the current page's form, as an object created
directly by <code>CGI::FormBuilder-&gt;new</code>. All valid <strong>FormBuilder</strong>
methods and options work on the form. To change which form is
returned, us <code>page()</code>.</p>
<p>
</p>
<h2><a name="page__num_"><code>page($num)</code></a></h2>
<p>This sets and returns the current page. It can accept a page number
either as an argument, or directly as an assignment:</p>
<pre>
    $multi-&gt;page(1);    # page 1
    $multi-&gt;page = 1;   # same thing

    $multi-&gt;page++;     # next page
    $multi-&gt;page--;     # back one

    if ($multi-&gt;page == $multi-&gt;pages) {
        # last page
    }</pre>
<p>Hint: Usually, you should only change pages once you have validated
the current page's form appropriately.</p>
<p>
</p>
<h2><a name="pages__"><code>pages()</code></a></h2>
<p>This returns the total number of pages. Actually, what it returns
is an array of all forms (and hence it has the alias <code>forms()</code>),
which just so happens to become the length in a scalar context,
just like anywhere else in Perl.</p>
<p>
</p>
<h2><a name="navbar__onoff_"><code>navbar($onoff)</code></a></h2>
<p>This returns a navigation bar that allows the user to jump between
pages of the form. This is useful if you want to let a person fill
out different pages out of order. In most cases, you do <em>not</em>
want this, so it's off by default.</p>
<p>To use it, the best way is setting <code>navbar =&gt; 1</code> in <code>new()</code>.
However, you can also get it yourself to render your own HTML:</p>
<pre>
    my $html = $multi-&gt;navbar;      # scalar HTML
    my @link = $multi-&gt;navbar;      # array of links</pre>
<p>This is useful in something like this:</p>
<pre>
    my $nav = $multi-&gt;navbar;
    $form = $multi-&gt;form;
    $form-&gt;tmpl_param(navbar =&gt; $navbar);</pre>
<p>The navbar will have two style classes: <code>fb_multi_page</code> for the
current page's link, and <code>fb_multi_link</code> for the others.</p>
<p>
</p>

<h1><a name="see_also">SEE ALSO</a></h1>
<p><a href="/download/CGI-FormBuilder-3.0202/docs/CGI/FormBuilder.html">the CGI::FormBuilder manpage</a></p>
<p>
</p>

<h1><a name="revision">REVISION</a></h1>
<p>$Id: Multi.pm,v 1.8 2005/03/09 18:43:23 nwiger Exp $</p>
<p>
</p>

<h1><a name="author">AUTHOR</a></h1>
<p>Copyright (c) 2005 Nathan Wiger &lt;<a href="mailto:nate@sun.com">nate@sun.com</a>&gt;. All Rights Reserved.</p>
<p>This module is free software; you may copy this under the terms of
the GNU General Public License, or the Artistic License, copies of
which should have accompanied your Perl kit.</p>




</td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="2" class="bar">
<tr><td align="center" class="bar">
FormBuilder is &copy; 2000-2006 <a href="/contrib/author.pl" class="bar">Nate Wiger</a>,
with contributions from <a href="/contrib/" class="bar">many people</a>.
</td></tr></table>
<div align="center">
<a href="http://www.nateware.com/"><img src="/images/nateware_powered.gif"
 border="0" width="92" height="33" alt="Nateware" /></a>
</div>
</body></html>
